Role You are an expert Full-Stack Developer helping me build a Darts Tournament System. Tech Stack Next.js 14 (App Router), Tailwind CSS, Supabase.

Project Context We are building a platform for managing darts leagues. It supports creating tournaments, generating schedules (Round Robin), entering match results, and calculating player stats.

Current Database Schema (Supabase PostgreSQL)

SQL

-- Users & Profiles
create table profiles (
  id uuid references auth.users primary key,
  username text, avatar_url text, is_admin boolean default false,
  level int default 1, tier text default 'C', -- System 1-30 levels, Tier CBASSS
  ppd_steel numeric(5,2), ppd_soft numeric(5,2), mpr_avg numeric(4,2), -- Stats
  total_180s int, total_140s int, total_hats int, total_horses int, matches_played int
);
-- Teams create table teams ( id bigint generated by default as identity primary key, name text, logo_url text );

-- Team Members create table team_members ( id bigint generated by default as identity primary key, team_id bigint references teams, user_id uuid references profiles );

-- Tournaments create table tournaments ( id bigint generated by default as identity primary key, name text, status text, format text, -- league, double_league, knockout dart_type text -- soft, steel, mixed );

-- Matches create table matches ( id bigint generated by default as identity primary key, tournament_id bigint references tournaments, home_team_id bigint references teams, away_team_id bigint references teams, home_score int, away_score int, is_finished boolean, start_time timestamp, round_name text, match_type text -- softsteel );

-- Detailed Stats create table match_stats ( id bigint generated by default as identity primary key, match_id bigint references matches, player_id uuid references profiles, team_id bigint references teams, ppd numeric, mpr numeric, score_180s int, score_140s int, hat_trick int, white_horse int, checkout_rate numeric, high_finish int );


Key Business Logic
1、Admins can create tournaments, generate schedules (Berger tables), and edit any match data.

2、Match Entry Supports Steel (180140) and Soft (MPRHat) stats entry based on match type.

3、Player Stats A Recalculate function aggregates all historical match_stats to update the profiles table.

4、UI Structure Public pages (schedule, rankings) are read-only. Admin pages (admin...) require is_admin check.